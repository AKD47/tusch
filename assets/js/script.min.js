$(document).ready(function () {

    /*mobile menu trigger*/
    $(document).on('click', '#mobile-trigger', function (event) {
        event.preventDefault();
        var menu = $(this).closest('.header__navigation').find('.header__nav');
        if ($(this).hasClass('js-trigger-active')) {
            $(this).removeClass('js-trigger-active');
            menu.slideUp('slow');
        } else {
            $(this).addClass('js-trigger-active');
            menu.slideDown('slow');
        }
        return false;
    });
    if (window.innerWidth < 756) {
        $(document).mouseup(function (event) {
            var block = $('.header__navigation');
            if (!block.is(event.target)
                && block.has(event.target).length === 0) {
                $('#mobile-trigger').removeClass('js-trigger-active');
                $('.header__nav').slideUp('500');
            }
        });
    }
    /*close*/

    /*main banner slider*/
    $('#main-banner').slick({
        dots: true,
        arrows: false,
        autoplay: true,
        autoplaySpeed: 2000,
        infinite: true,
        speed: 500,
        fade: true,
        cssEase: 'linear'
    });
    /*close*/

    /*modal*/
    $(document).on('click', '.products__element.show-modal', function () {
        event.preventDefault();
        $('#overlay').fadeIn(400,
            function () {
                $('.modal').css('display', 'block').animate({opacity: 1}, 200);
            });
    });
    $(document).on('click', '.modal__close, #overlay', function () {
        $('.modal').animate({opacity: 0}, 200,
            function () {
                $(this).css('display', 'none');
                $('#overlay').fadeOut(400);
            }
        );
    });
    /*close*/

    /*category change*/
    $(document).on('change', '#catSelect', function(event) {
        relocateByCat(event);
        // var selected = $(this).val();
        // $.ajax({
        //     url: myajax.url,
        //     type: 'POST',
        //     data: {
        //         action: 'myCatAjax',
        //         catID: selected
        //     },
        //     beforeSend: function(xhr) {},
        //     success: function(data) {
        //         var jjdata = JSON.parse(data);
        //         var container = document.getElementById('customCategoryPosts');
        //         container.innerHTML = "";
        //         for (var i = 0; i < 4; i++) {
        //             var placeholder = '<img src="http://tusch-wp/wp-content/plugins/woocommerce/assets/images/placeholder.png" alt="Placeholder" width="300" class="woocommerce-placeholder wp-post-image" height="300">';
        //             if (jjdata[i].post_modified == "") {
        //                 var image = placeholder;
        //             } else {
        //                 image = jjdata[i].post_modified;
        //             }
        //             var html =
        //                 '<div class="catalog__element ' + jjdata[i].ID +' product type-product status-publish product_cat-cat_1_9 product_cat-uncategorized product_cat-cat_1 first instock shipping-taxable product-type-simple">\n' +
        //                 '\n' +
        //                 '    <a href=" '+ jjdata[i].guid +' " class="woocommerce-LoopProduct-link woocommerce-loop-product__link">\n' +
        //                 '    <div class="catalog__element--photo">\n' +
        //                 image +
        //                 '        </div>\n' +
        //                 '\n' +
        //                 '    <div class="catalog__element--descr">\n' +
        //                 '        <h2 class="woocommerce-loop-product__title">' + jjdata[i].post_title + '</h2>' +
        //                 '<p>' + jjdata[i].post_mime_type +'</p>\n' +
        //                 '        <span>DETAIL</span>\n' +
        //                 '    </div>\n' +
        //                 '\n' +
        //                 '    \n' +
        //                 '\n' +
        //                 '    </a></div>';
        //             container.innerHTML += html;
        //             console.log(jjdata.length);
        //         }
        //     },
        //     error: function() {
        //         console.log('Error');
        //     }
        // });
    });
    /*category change*/

    /*subcategory change*/
    $(document).on('change', '#subcatSelect', function() {
        relocateByCat(event);
    });

    function relocateByCat(event) {
        var selected = $(event.target).val();
        if (selected == 0) {
            return;
        } else if (selected == 15) {
            var stateObj = {innerhtml: document.body.innerHTML};
            window.history.pushState(stateObj, '/shop', '/shop');
            location.reload();
        } else {
            $.ajax({
                url: myajax.url,
                type: 'POST',
                data: {
                    action: 'myCatAjax',
                    catID: selected
                },
                beforeSend: function (xhr) {
                },
                success: function (data) {
                    var jdata = JSON.parse(data);
                    var stateObj = {innerhtml: document.body.innerHTML};
                    window.history.pushState(stateObj, '/product-category/' + jdata.slug, '/product-category/' + jdata.slug);
                    location.reload();
                    // window.location = '/product-category/' + jdata.slug;
                },
                error: function () {
                    console.log('Error');
                }
            });
        }
    }
    /*category change*/

});